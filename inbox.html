<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>אפליקציית כושר מאובטחת</title>
    <style>
        /* הסגנונות נשארים אותו דבר */
    </style>
</head>
<body>
    <!-- התוכן HTML נשאר אותו דבר -->

    <script>
        // פונקציה להגנה מפני XSS
        function escapeHtml(unsafe) {
            return unsafe
                 .replace(/&/g, "&amp;")
                 .replace(/</g, "&lt;")
                 .replace(/>/g, "&gt;")
                 .replace(/"/g, "&quot;")
                 .replace(/'/g, "&#039;");
        }

        function toggleAllergyDetails() {
            const allergyDetails = document.getElementById('allergyDetails');
            allergyDetails.style.display = document.getElementById('hasAllergies').checked ? 'block' : 'none';
        }

        function generateNutritionPlan() {
            const dislikedFoods = escapeHtml(document.getElementById('dislikedFoods').value);
            const hasAllergies = document.getElementById('hasAllergies').checked;
            const allergies = hasAllergies ? escapeHtml(document.getElementById('allergyList').value) : 'אין אלרגיות';

            const planResult = `
                <h3>תוכנית תזונה מותאמת אישית</h3>
                <p><strong>מאכלים שאינך אוהב:</strong> ${dislikedFoods || 'לא צוין'}</p>
                <p><strong>אלרגיות:</strong> ${allergies}</p>
                <p>תוכנית התזונה תיווצר בהתאם להעדפות ולאלרגיות שציינת.</p>
            `;
            document.getElementById('nutritionPlanResult').innerHTML = planResult;
        }

        const recipes = [
            { name: 'אורז מלא עם ירקות', ingredients: 'אורז מלא, גזר, ברוקולי, בצל, שמן זית', instructions: 'לבשל את האורז...' },
            { name: 'ביצה מקושקשת', ingredients: 'ביצים, חלב, מלח, פלפל', instructions: 'לערבב את הביצים...' },
            { name: 'גספצ\'ו', ingredients: 'עגבניות, מלפפונים, פלפל אדום, שום, שמן זית', instructions: 'לטחון את כל הירקות...' },
            { name: 'דג סלמון צרוב', ingredients: 'פילה סלמון, לימון, שמן זית, מלח, פלפל', instructions: 'לחמם מחבת...' }
        ];

        function displayRecipes() {
            const recipeList = document.getElementById('recipeList');
            recipeList.innerHTML = '';
            recipes.forEach(recipe => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <h3>${escapeHtml(recipe.name)}</h3>
                    <p><strong>מצרכים:</strong> ${escapeHtml(recipe.ingredients)}</p>
                    <p><strong>הוראות הכנה:</strong> ${escapeHtml(recipe.instructions)}</p>
                `;
                recipeList.appendChild(li);
            });
        }

        function filterRecipes() {
            const searchTerm = document.getElementById('recipeSearch').value.toLowerCase();
            const recipeList = document.getElementById('recipeList');
            recipeList.innerHTML = '';
            recipes.forEach(recipe => {
                if (recipe.name.toLowerCase().includes(searchTerm)) {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <h3>${escapeHtml(recipe.name)}</h3>
                        <p><strong>מצרכים:</strong> ${escapeHtml(recipe.ingredients)}</p>
                        <p><strong>הוראות הכנה:</strong> ${escapeHtml(recipe.instructions)}</p>
                    `;
                    recipeList.appendChild(li);
                }
            });
        }

        // הצג את כל המתכונים בטעינת העמוד
        window.onload = displayRecipes;
    </script>
</body>
</html>
